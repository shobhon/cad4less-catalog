{% extends 'base.html' %}
{% block content %}
<h2>Products (PCs)</h2>

<form method="post" action="{{ url_for('delete_builds') }}" onsubmit="return confirm('Delete selected PCs? This cannot be undone.');">
  <p>
    <a class="btn" href="{{ url_for('import_catalog') }}">Import CSV</a>
    <a class="btn" href="{{ url_for('list_parts') }}">View Parts</a>
    <a class="btn" href="{{ url_for('new_build_form') }}">New Build</a>
    <button class="btn secondary" type="submit">Delete Selected</button>
  </p>

  {% if builds %}
  <table>
    <thead>
      <tr>
        <th><input type="checkbox" onclick="for(const cb of document.querySelectorAll('.row-select')) cb.checked=this.checked;"></th>
        <th>ID</th><th>Name</th><th># Parts</th><th>Total Price</th><th>Created</th>
      </tr>
    </thead>
    <tbody>
    {% for b in builds %}
      <tr>
        <td><input class="row-select" type="checkbox" name="selected_ids" value="{{ b.id }}"></td>
        <td>{{ b.id }}</td>
        <td>{{ b.name }}</td>
        <td>{{ b.part_count }}</td>
        <td>${{ "%.2f"|format(b.total_price) }}</td>
        <td>{{ b.created_at }}</td>
      </tr>
    {% endfor %}
    </tbody>
  </table>
  {% else %}
    <p><em>No PCs found. Try importing the Shopify CSV.</em></p>
  {% endif %}
</form>
{% endblock %}