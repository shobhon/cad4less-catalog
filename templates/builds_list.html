{% extends 'base.html' %}
{% block content %}
<h2>Builds</h2>

{% if builds %}
<table>
  <thead><tr><th>ID</th><th>Name</th><th>Total Price</th><th>Created</th></tr></thead>
  <tbody>
    {% for b in builds %}
      <tr>
        <td>{{ b.id }}</td>
        <td>{{ b.name }}</td>
        <td>
          {% if b.total_price is defined %}
            ${{ "%.2f"|format(b.total_price()) }}
          {% else %}
            <!-- models.py without total_price(): compute inline -->
            ${{ "%.2f"|format((b.build_parts|map(attribute='part.price')|sum) or 0) }}
          {% endif %}
        </td>
        <td>{{ b.created_at or "" }}</td>
      </tr>
    {% endfor %}
  </tbody>
</table>
{% else %}
<p>No builds yet. <a class="btn" href="{{ url_for('new_build_form') }}">Create your first build</a></p>
{% endif %}

<p><a class="btn" href="{{ url_for('new_build_form') }}">New Build</a></p>
{% endblock %}